---
title: "mao"
author: "Thomas Van Hoey"
date: "20-5-2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Mao 貌 as a predictor for ideophones

The idea is that *mao* 貌 can focus as a predictor in dictionary definitions.
Let's calculate the stats in CHIDEOD.

```{r}
library(CHIDEOR)
library(tidyverse)
```

Loading the tidy hydcd
```{r}
tidy.hydcd <- read_rds("/Users/Thomas/Google\ Drive/hydcd/tidyHYDCD.rds")
```


```{r}
db <- full_database

# select relevant columns and left join
db_hydcd <- db %>% 
  select(traditional) %>%
  left_join(tidy.hydcd, by = c("traditional" = "item")) %>%
  select(-computemeaning)

# only numbered meanngs, examples gone
db_hydcd %>%
  filter(str_detect(printmeaning, "^[:digit:]")) %>%
  separate(printmeaning, into = c("meaning", "example"), sep = "\n") %>%
  distinct() -> db_tidy
```


How many have the marker mao in their definition?
```{r}
distincts <- db_tidy %>%
  distinct(traditional) 

distinctsmao <- db_tidy %>%
  filter(str_detect(meaning, "貌")) %>%
  distinct(traditional) 

distinctssheng <- db_tidy %>%
  filter(str_detect(meaning, "聲")) %>%
  distinct(traditional) 

# numbers
nrow(distincts)
nrow(distinctsmao)
nrow(distinctssheng)

# overlap

#intersect(distinctsmao, distinctssheng)
intersect(distinctsmao, distinctssheng) %>% nrow()
```

So we can see that there are `nrow(distincts)` distinct ideophones in CHIDEOD that have a definition in HYDCD.
Of these `nrow(distinctsmao)` have *mao* 貌 as a marker; and `nrow(distinctssheng)` *sheng* 聲 as a marker.
There is some overlap, namely n = `intersect(distinctsmao, distinctssheng) %>% nrow()`. 

This means that *mao* is a pretty good marker for ideophones: `nrow(distinctsmao) / nrow(distincts)`.

# Mao for finding new possible ideophones

So let's say we have *mao*, let's look in HYDCD at all the definitions that have this marker, in a somewhat onomasiological fashion.

```{r}
hydcd_split <- tidy.hydcd %>%
  select(-computemeaning) %>%
  filter(str_detect(printmeaning, "^[:digit:]")) %>%
  separate(printmeaning, into = c("meaning", "example"), sep = "\n") %>%
  distinct() 

hydcd_mao <- hydcd_split %>%
  filter(str_detect(meaning, "貌。")) # add period

hydcd_sheng <- hydcd_split %>%
  filter(str_detect(meaning, "聲。")) # add period

```

Which ones **do not** occur in CHIDEOD?
```{r}
hydcd_mao %>%
  anti_join(distinctsmao, by = c("item" = "traditional")) %>%
  group_by(item) %>%
  mutate(meaning = paste(meaning, collapse = "; "),
         example = paste(example, collapse = "; ")) %>%
  distinct() -> hydcd_mao2


hydcd_sheng %>%
  anti_join(distinctsmao, by = c("item" = "traditional")) %>%
  group_by(item) %>%
  mutate(meaning = paste(meaning, collapse = "; "),
         example = paste(example, collapse = "; ")) %>%
  distinct() -> hydcd_sheng2

#hydcd_mao2
#hydcd_sheng2
```

These results can now be further examined in a spreadsheet.
They are possible candidates

```{r}
write_csv(hydcd_mao2, "hydcd_mao.csv", col_names = TRUE)
write_csv(hydcd_sheng2, "hydcd_sheng.csv", col_names = TRUE)
```












